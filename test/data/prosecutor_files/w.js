;(function(){var a=function(){function a(a){var b,d,e=this,g=a.length,h=0,i=e.i=e.j=e.m=0;for(e.S=[],e.c=[],g||(a=[g++]);f>h;)e.S[h]=h++;for(h=0;f>h;h++)b=e.S[h],i=c(i+b+a[h%g]),d=e.S[i],e.S[h]=d,e.S[i]=b;e.g=function(a){var b=e.S,d=c(e.i+1),g=b[d],h=c(e.j+g),i=b[h];b[d]=i,b[h]=g;for(var j=b[c(g+i)];--a;)d=c(d+1),g=b[d],h=c(h+g),i=b[h],b[d]=i,b[h]=g,j=j*f+b[c(g+i)];return e.i=d,e.j=h,j;},e.g(f);}function b(a,b,d,e){for(a+="",d=0,e=0;a.length>e;e++)b[c(e)]=c((d^=19*b[c(e)])+a.charCodeAt(e));a="";for(e in b)a+=String.fromCharCode(b[e]);return a;}function c(a){return a&f-1;}var d=[],e={},f=256,g=6,h=52;e.seed=function(c){var k,l=[];return c=b(c,l),k=new a(l),b(k.S,d),e.random=function(){for(var a=k.g(g),b=i,c=0;h>a;)a=(a+c)*f,b*=f,c=k.g(1);for(;a>=j;)a/=2,b/=2,c>>>=1;return(a+c)/b;},c;};var i=Math.pow(f,g),h=Math.pow(2,h),j=2*h;return b(Math.random(),d),function(a){return e.seed(a),function(){return e.random();};};}();var b;if(!b)b={};(function(){function a(a){return a<10?"0"+a:a;}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(b){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z":null;};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(a){return this.valueOf();};}var c=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,d=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e,f,g={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},h;function i(a){d.lastIndex=0;return d.test(a)?'"'+a.replace(d,function(a){var b=g[a];return typeof b==="string"?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4);})+'"':'"'+a+'"';}function j(a,b){var c,d,g,k,l=e,m,n=b[a];if(n&&typeof n==="object"&&typeof n.toJSON==="function")n=n.toJSON(a);if(typeof h==="function")n=h.call(b,a,n);switch(typeof n){case "string":return i(n);case "number":return isFinite(n)?String(n):"null";case "boolean":case "null":return String(n);case "object":if(!n)return "null";e+=f;m=[];if(Object.prototype.toString.apply(n)==="[object Array]"){k=n.length;for(c=0;c<k;c+=1)m[c]=j(c,n)||"null";g=m.length===0?"[]":e?"[\n"+e+m.join(",\n"+e)+"\n"+l+"]":"["+m.join(",")+"]";e=l;return g;}if(h&&typeof h==="object"){k=h.length;for(c=0;c<k;c+=1)if(typeof h[c]==="string"){d=h[c];g=j(d,n);if(g)m.push(i(d)+(e?": ":":")+g);}}else for(d in n)if(Object.prototype.hasOwnProperty.call(n,d)){g=j(d,n);if(g)m.push(i(d)+(e?": ":":")+g);}g=m.length===0?"{}":e?"{\n"+e+m.join(",\n"+e)+"\n"+l+"}":"{"+m.join(",")+"}";e=l;return g;}}if(typeof b.stringify!=="function")b.stringify=function(a,b,c){var d;e="";f="";if(typeof c==="number")for(d=0;d<c;d+=1)f+=" ";else if(typeof c==="string")f=c;h=b;if(b&&typeof b!=="function"&&(typeof b!=="object"||typeof b.length!=="number"))throw new Error("JSON.stringify");return j("",{"":a});};if(typeof b.parse!=="function")b.parse=function(a,b){var d;function e(a,c){var d,f,g=a[c];if(g&&typeof g==="object")for(d in g)if(Object.prototype.hasOwnProperty.call(g,d)){f=e(g,d);if(f!==undefined)g[d]=f;else delete g[d];}return b.call(a,c,g);}a=String(a);c.lastIndex=0;if(c.test(a))a=a.replace(c,function(a){return "\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4);});if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){d=eval("("+a+")");return typeof b==="function"?e({"":d},""):d;}throw new SyntaxError("JSON.parse");};}());window._umbel=window._umbel||[];var c=encodeURIComponent,d=decodeURIComponent;var e={build_qs:function(a){var b="";for(var d in a){var e=a[d];b+=c(d)+"="+c(e)+"&";}if(b.length>0)b=b.substring(0,b.length-1);return b;},parse_qs:function(a){var b={};if(typeof a!='string')return b;a.replace(/([^=&]+)=([^&]*)/gi,function(a,c,e){b[d(c)]=d(e);});return b;},get_get_vars:function(a){if(typeof a==='undefined')var a=window.location.href;var b=a.split(/\?(.+)/);if(b.length!=3)return{};return this.parse_qs(b[1]);},get_hash_vars:function(){return this.parse_qs(window.location.href.split(/#(.+)/)[1]);}};var f=function(){this.queue_kv=new h('umbel1-q');this.values_kv=new h('umbel1-v');this.daily_kv=new h('umbel1-d');this.init_id();this.event_blacklist=['session.ping'];this.unique=0;};f.prototype={api_key:'bvxlaycgrshpqpra',send_data:function(a,c){a.unique=++this.unique;var d=new Image();if(typeof c=='function')d.onload=c;d.style.visibility='hidden';d.style.display='none';d.src='https://bvxlaycgrshpqpra.capture.umbel.com/measure.gif?'+e.build_qs({'json':b.stringify(a)});},delete_queued:function(a){var b=this.queue_kv;return function(){b.del(a,true);};},send_queued:function(){var a=this.queue_kv.get_all();for(var c in a)try{var d=b.parse(a[c]);d.timestamp=c;d.browser_id=this.browser_id;d.api_key=this.api_key;this.send_data(d,this.delete_queued(c));}catch(e){this.delete_queued(c)();}},send_bp:function(a){var b='https://backplane.umbel.com/auth.php?messageURL='+c(a)+'&umbel_id='+this.browser_id+'&api_key='+this.api_key+'&ts='+this.isodate();var d=new XMLHttpRequest();d.open("GET",b,false);d.send(null);},isodate:function(a){a=a||new Date();if(a.toISOString)return a.toISOString();var b=function(a){return a<10?'0'+a:a;};var c=a.getUTCFullYear()+'-'+b(a.getUTCMonth()+1)+'-'+b(a.getUTCDate())+'T'+b(a.getUTCHours())+':'+b(a.getUTCMinutes())+':'+b(a.getUTCSeconds())+'.'+b(a.getUTCMilliseconds())+'Z';return c;},gen_id:function(){var b=a(this.isodate()+Math.random().toString()+document.cookie+navigator.userAgent);return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g,function(a){var c=b()*16|0,d=a=='x'?c:(c&0x3|0x8);return d.toString(16);});},init_id:function(){var a=g.get('umbel_browser_id');if(!a)var a=this.gen_id();g.set('umbel_browser_id',a,365);this.browser_id=a;},valid_event:function(a){var b,e,f;if(a instanceof Array){var g=a.length;if(g>3||g<2)return;e=a[1];b=a[0];f=(g==3)?a[2]:'';}else if(typeof a==='object'){e=a.name;if(!e)return;b=a.type||'send';f=a.value||null;}if(this.event_blacklist.indexOf(e)!=-1)return;if(b=='set'){var h=this.values_kv.get(e);if(h==f)return;else this.values_kv.set(e,f,true);}else if(b=='tag'){var i=this.values_kv.get(e);if(typeof i!='undefined'){var j=i.split('|');for(var k=0;k<j.length;k++)if(d(j[k])==f)return;this.values_kv.set(e,i+'|'+c(f),true);}else this.values_kv.set(e,c(f),true);}else if(b=='daily'){var l=new Date();var m=l.getFullYear()+'-'+l.getMonth()+'-'+l.getDate();var n=this.daily_kv.get(e);if(n==m)return;else this.daily_kv.set(e,m,true);}else if(b!='send')return;if(e=='umbel.backplane')this.send_bp(f);var o=this.isodate();var p={name:e,value:f,timestamp:o,browser_id:this.browser_id,api_key:this.api_key};if(window._umbel_test_mode)p.testing=true;return p;},send_event:function(a){var c=this.valid_event(a);if(c==undefined)return;var d=this;var e=function(a){d.queue_kv.set(c.timestamp,b.stringify({'name':c.name,'value':a}),true);c.value=a;d.send_data(c,d.delete_queued(c.timestamp));};if(typeof c.value=='function')c.value(e);else e(c.value);},patch_push:function(){for(var a=0;a<_umbel.length;a++)this.send_event(_umbel[a]);_umbel.length=0;var b=this;_umbel.push=function(a){b.send_event(a);};},send_builtin_events:function(){_umbel.push({'type':'daily','name':'daily.unique'});_umbel.push({'type':'set','name':'app.user_agent','value':navigator.userAgent});}};var g={set:function(a,b,c,d,e){if(typeof d==='undefined')d='/';if(typeof e==='undefined'){var f=document.domain.split('.');e='.'+f[f.length-2]+'.'+f[f.length-1];}var g=new Date();g.setDate(g.getDate()+c);var h=escape(b)+((c==undefined)?"":"; expires="+g.toUTCString())+((d===null)?'':'; path='+d)+((e===null)?'':'; domain='+e);var i=a+"="+h;document.cookie=i;},get:function(a){var b=this.get_match(function(b){return(a===b);});if(b.length)return b[0][1];},get_match:function(a){var b,c,d,e=[],f=document.cookie.split(";");for(b=0;b<f.length;b++){c=f[b].substr(0,f[b].indexOf("="));d=f[b].substr(f[b].indexOf("=")+1);c=c.replace(/^\s+|\s+$/g,"");if(a(c))e.push([c,unescape(d)]);}return e;},del:function(a,b,c){this.set(a,'',-1,b,c);}};var h=function(a){this.namespace=a||'umbel1-v';this.cache=this.get_all();};h.prototype={get_all:function(){var a=this.namespace;var b=g.get_match(function(b){return b.slice(0,a.length)==a;});this.cc=b.length;var c={};b.map(function(a){var b=e.parse_qs(a[1]);for(var d in b)c[d]=b[d];});return c;},get:function(a){return this.cache[a];},set:function(a,b,c){this.cache[a]=b;if(c)this.commit();},del:function(a,b){delete this.cache[a];if(b)this.commit();},commit:function(){var a=[];for(var b in this.cache){var c={};c[b]=this.cache[b];a.push(e.build_qs(c));}var d=[];var f='';for(var h=0;h<a.length;h++){if(a[h].length+f.length>4000){d.push(f);f='';}if(f==='')f=a[h];else f+='&'+a[h];}if(f)d.push(f);this.cc=Math.max(this.cc,d.length);for(var h=0;h<this.cc;h++)if(h<d.length)g.set(this.namespace+h,d[h]);else g.del(this.namespace+h);}};var i=function(){var a=g.get_match(function(){return true;});var b=false;var c=null;for(var d=0;d<a.length;d++){if(a[d][0].slice(0,7)=='umbel0-'){g.del(a[d][0],null,null);g.set('umbel1-'+a[d][0].slice(7),a[d][1],365);b=true;}if(a[d][0]=='umbel_browser_id'){if(c)_umbel.push(['send','umbel.duplicate_browser_id']);c=a[d][1];}}if(b){_umbel.push(['send','umbel.migrate']);if(c){g.del('umbel_browser_id',null,null);g.set('umbel_browser_id',c,365);}}};var j=function(){i();var a=new f();a.patch_push();a.send_queued();a.send_builtin_events();};try{j();}catch(k){}})();